{
   "name": "packetbeat",
   "options": [
      {
         "name": "protocols",
         "type": "obj",
         "list": true,
         "value": [
            {
               "name": "type",
               "type": "choice",
               "value": [
                  "dchpv4",
                  "dns",
                  "http",
                  "memcache",
                  "mysql",
                  "pgsql",
                  "redis",
                  "thrift",
                  "mongodb",
                  "cassandra",
                  "tls"
               ]
            },
            {
               "name": "ports",
               "type": "integer",
               "list": true
            }
         ]
      },
      {
         "name": "interfaces.device",
         "type": "string",
         "list": true
      }
   ],
   "config": [
      {
         "name": "/etc/packetbeat/packetbeat.yml",
         "type": "filename",
         "content": "..."
      }
   ],
   "recipe": {
      "start": [
         "sudo service packetbeat start"
      ],
      "stop": [
         "sudo service packetbeat stop"
      ],
      "install": [
         "sudo apt-get install libpcap0.8",
         "curl -L -O https://artifacts.elastic.co/downloads/beats/packetbeat/packetbeat-7.3.0-amd64.deb",
         "sudo dpkg -i packetbeat-7.3.0-amd64.deb",
         "rm packetbeat-7.3.0-amd64.deb"
      ],
      "uninstall": [
         "sudo apt purge packetbeat"
      ]
   }
}